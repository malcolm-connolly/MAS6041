Some of the steps in this process were computationally intensive.
In order to work more efficiently I saved larger objects for later use as RData files.
The largest of these objects is the lookup table X. 

